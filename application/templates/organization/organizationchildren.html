{% extends "layout.html" %}
{% block title %}Organization Children Page{% endblock %}
{% block content %}
 
<div class="row">
  <div class="col-lg-8 col-md-10 mx-auto">
    <h1> Organization Info </h1>
  </div>
</div>
<div class="row" id="childrenInfo">
  
  <div class="col-sm-6">
    <img :src="childImage" :alt="child.name" width="250px">
    <div class="row">[[child.name]] ([[child.age]][[child.sex.charAt(0)]])</div>
    <div class="row">Email: [[child.email]]</div>
    <div class="row">Address: [[child.address]]</div>
    <div class="row">Shirt Size: [[child.cloth_size]]</div>
    <div class="row">Pant Size: [[child.pant_size]]</div>
    <div class="row">Shoe Size: [[child.shoes_size]]</div>
  </div>

  <div class="col-sm-6">
    <div class="row" v-for="gift in child.items">
        [[gift.name]]: $[[gift.amount]]
    </div>
    <div class="row">Goal Price: $[[goal_price]]</div>
    <div class="row">Total Price: $[[total_price]]</div>
  </div>

</div> 
{% endblock %}

{% block script %}
<script>
  var childId = new URL(location.href).searchParams.get('childId')

  var app = new Vue({
    el: "#childrenInfo",
    delimiters: ['[[', ']]'],
    data: {
      child: {
        id: 1,
        email: "email@address",
        name: "Joe Bob",
        phone: "123",
        age: 7,
        about_me: "I'm Cool",
        address: "78 road",
        cloth_size: "XXXXXXXL",
        sex: "M",
        gender: "M",
        pant_size: "28",
        shoes_size: "7",
        fav_color: "Orange",
        items: [
              {id:1, name:"bike", amount: 10},
              {id:2, name:"yoyo", amount: 11},
              {id:3, name:"doggie", amount: 12}
            ]
      },
      goal_price: 102
    },
    methods: {
        fetchData: function(){
          this.$http.get('/api/1.0/children/' + childId).then(response => {
              console.log(response.body);
              this.child =  response.body;
          }, error => {
              console.log(error);
          });
        }
    },
    computed: {
      childImage () {
        if (!this.child.id) {
          return
        }

        const fileName = this.child.id;

        return "../../static/img/kids/" + fileName + ".jpg" // the module request
      },
      total_price: function(){

        let sum = 0;
        this.child.items.forEach(gift => {
          sum += gift.amount;
        });
        return sum;
      }
    }
  });

  app.fetchData();
</script>
{% endblock %}

